<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Administrador - Ranking Final</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="container">
    <h1>Asignar Ranking Final</h1>
    <form id="ranking-form">
      <div id="ranking"></div>
      <button type="submit" class="btn">Guardar Ranking Final</button>
    </form>
    <p id="mensaje" style="color: yellow; margin-top: 1rem;"></p>
  </div>

  <script>
    const paises = [
      { nombre: "Suecia", codigo: "se" },
      { nombre: "España", codigo: "es" },
      { nombre: "Italia", codigo: "it" },
      { nombre: "Francia", codigo: "fr" },
      { nombre: "Alemania", codigo: "de" },
      { nombre: "Grecia", codigo: "gr" },
      { nombre: "Noruega", codigo: "no" },
      { nombre: "Reino Unido", codigo: "gb" },
      { nombre: "Polonia", codigo: "pl" },
      { nombre: "Ucrania", codigo: "ua" }
    ];

    const contenedor = document.getElementById("ranking");

    paises.forEach((pais, index) => {
      const div = document.createElement("div");
      div.className = "pais";
      div.innerHTML = `
        <img src="images/${pais.codigo}.svg" alt="${pais.nombre}">
        <label>${pais.nombre}</label>
        <select name="posicion" data-index="${index}" required>
          <option value="">-- Posición --</option>
          ${[...Array(10)].map((_, i) => `<option value="${i + 1}">${i + 1}</option>`).join('')}
        </select>
      `;
      contenedor.appendChild(div);
    });

    document.getElementById("ranking-form").addEventListener("submit", function(e) {
      e.preventDefault();

      const selects = document.querySelectorAll("select[name='posicion']");
      const posiciones = [];
      const valores = new Set();

      for (const select of selects) {
        const valor = parseInt(select.value);
        if (!valor || valores.has(valor)) {
          document.getElementById("mensaje").textContent = "Error: Posiciones duplicadas o vacías.";
          return;
        }
        valores.add(valor);
        posiciones.push({
          pais: paises[select.dataset.index].nombre,
          posicion: valor
        });
      }

      localStorage.setItem("top10_final", JSON.stringify(posiciones));
      document.getElementById("mensaje").textContent = "✅ Ranking final guardado correctamente.";
    });
  </script>
</body>
</html>
